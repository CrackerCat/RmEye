"use strict";(globalThis["webpackChunksyseye"]=globalThis["webpackChunksyseye"]||[]).push([[763],{1763:(t,e,s)=>{s.r(e),s.d(e,{default:()=>Z});var a=s(3673),i=s(2323);const o={class:"q-gutter-md q-mb-sm q-pa-lg"},l={class:"row q-col-gutter-sm"},n={class:"text-h6"},r=(0,a.Uk)(" 由于python+sqlite数据库作为后端,理论上最高支持的主机数量为50. "),c={class:"text-subtitle2"},h={ref:"main_draw",style:{width:"100%",height:"600px"}};function m(t,e,s,m,u,d){const p=(0,a.up)("q-icon"),w=(0,a.up)("q-item-section"),g=(0,a.up)("q-item-label"),_=(0,a.up)("q-item"),b=(0,a.up)("q-card-section"),f=(0,a.up)("q-card"),y=(0,a.up)("q-banner"),v=(0,a.up)("q-popup-proxy");return(0,a.wg)(),(0,a.iD)("div",o,[(0,a._)("div",null,[(0,a.Wm)(f,{class:"bg-transparent no-shadow no-border"},{default:(0,a.w5)((()=>[(0,a.Wm)(b,{class:"q-pa-none"},{default:(0,a.w5)((()=>[(0,a._)("div",l,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(t.Threatitems,((t,e)=>((0,a.wg)(),(0,a.iD)("div",{key:e,class:"col-md-3 col-sm-12 col-xs-12"},[(0,a.Wm)(_,{style:(0,i.j5)(`background-color: ${t.color1}`),class:"q-pa-none"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{side:"",style:(0,i.j5)(`background-color: ${t.color2}`),class:"q-pa-lg q-mr-none text-white"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{name:t.icon,color:"white",size:"24px"},null,8,["name"])])),_:2},1032,["style"]),(0,a.Wm)(w,{class:"q-pa-md q-ml-none text-white"},{default:(0,a.w5)((()=>[(0,a.Wm)(g,{class:"text-white text-h6 text-weight-bolder"},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(t.value),1)])),_:2},1024),(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(t.title),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["style"])])))),128))])])),_:1})])),_:1})]),(0,a.Wm)(f,{class:"no-shadow",style:{background:"rbg(255,255,255)"}},{default:(0,a.w5)((()=>[(0,a.Wm)(b,null,{default:(0,a.w5)((()=>[(0,a._)("div",n,[(0,a.Uk)(" 主机数量: "+(0,i.zw)(t.threatStatistics.host_num)+"/50 ",1),(0,a.Wm)(p,{name:"info",class:"text-brown cursor-pointer"},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{"transition-show":"flip-up","transition-hide":"flip-down"},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{class:"bg-brown text-white"},{avatar:(0,a.w5)((()=>[(0,a.Wm)(p,{name:"lightbulb"})])),default:(0,a.w5)((()=>[r])),_:1})])),_:1})])),_:1})]),(0,a._)("div",c,"最近日志数量: "+(0,i.zw)(t.threatStatistics.all_log_num),1)])),_:1}),(0,a.Wm)(b,{class:"q-pt-none"},{default:(0,a.w5)((()=>[(0,a._)("div",h," 1 ",512)])),_:1})])),_:1})])}var u=s(52),d=s.n(u),p=s(2256);const w=(0,a.aZ)({name:"Dashboard",data(){return{Threatitems:[{title:"发现的威胁",icon:"remove_red_eye",value:"200",color1:"#EE9B00",color2:"#EE9B00"},{title:"确认的威胁",icon:"flash_on",value:"500",color1:"#CA6702",color2:"#CA6702"},{title:"忽略的威胁",icon:"add_moderator",value:"50",color1:"#BB3E03",color2:"#BB3E03"},{title:"进行中的威胁",icon:"stream",value:"1020",color1:"#AE2012",color2:"#AE2012"}],threatStatistics:{all:1,confirm:0,ingore:1,working:0,host_list:{},host_num:10,all_log_num:647}}},methods:{get_threatStatistics(){d().get("/api/v1/get/threat_statistics",{"Content-Type":"application/json"}).then((t=>{const e=t.data;e.data&&(this.threatStatistics=e.data,this.threatStatistics.host_num=Object.keys(this.threatStatistics.host_list).length,this.Threatitems[0].value=this.threatStatistics.all,this.Threatitems[1].value=this.threatStatistics.confirm,this.Threatitems[2].value=this.threatStatistics.ingore,this.Threatitems[3].value=this.threatStatistics.working,console.log(this.threatStatistics),this.draw())}))},draw(){const t=[],e=[];for(const o in this.threatStatistics.host_list)t.push(o),e.push({itemStyle:{color:"#005F73"},name:o,type:"line",stack:"Total",areaStyle:{},emphasis:{focus:"series"},data:this.threatStatistics.host_list[o].log_num});const s=this.$refs.main_draw,a=p.S1(s),i={title:{text:"最近十分钟日志量"},tooltip:{trigger:"axis",axisPointer:{type:"cross",label:{backgroundColor:"#6a7985"}}},legend:{data:t},toolbox:{feature:{saveAsImage:{}}},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"category",boundaryGap:!1,data:["10min","9min","8min","7min","6min","5min","4min","3min","2min","1min"]}],yAxis:[{type:"value"}],series:e};a.setOption(i),setTimeout((()=>{a.resize()}),1e3)}},mounted(){this.get_threatStatistics(),setInterval((()=>{this.get_threatStatistics()}),1e4)}});var g=s(4260),_=s(151),b=s(5589),f=s(3414),y=s(2035),v=s(4554),x=s(2350),S=s(3944),q=s(5607),k=s(7518),W=s.n(k);const T=(0,g.Z)(w,[["render",m]]),Z=T;W()(w,"components",{QCard:_.Z,QCardSection:b.Z,QItem:f.Z,QItemSection:y.Z,QIcon:v.Z,QItemLabel:x.Z,QPopupProxy:S.Z,QBanner:q.Z})}}]);