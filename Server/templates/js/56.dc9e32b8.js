"use strict";(globalThis["webpackChunksyseye"]=globalThis["webpackChunksyseye"]||[]).push([[56],{8056:(t,e,a)=>{a.r(e),a.d(e,{default:()=>nt});var i=a(3673),l=a(2323);const s={class:"q-gutter-md q-mb-sm q-pa-lg"},o={class:"row q-col-gutter-sm"},n={class:"row"},r=(0,i._)("div",{class:"col"},null,-1),d={class:"col"},h={class:"row q-gutter-md q-mb-sm q-pa-lg"},c={key:0},u=(0,i._)("div",{class:"bg-red-5"}," ",-1),w=(0,i.Uk)(" 分数: "),p=(0,i.Uk)(" 活动状态: "),m=(0,i.Uk)(" ATTCK命中: "),g=(0,i.Uk)(" 产生的威胁: "),A=(0,i.Uk)(" 机器学习引擎 "),_=(0,i.Uk)(" 查看详情 "),k=(0,i.Uk)(" 在VT上搜索 "),f=(0,i.Uk)(" 确认威胁 "),C=(0,i.Uk)(" 忽略威胁 "),b=(0,i.Uk)(" 删除报警 "),v=(0,i._)("div",{class:"col"},null,-1),D=(0,i._)("div",{class:"text-h6"},"填写缘由",-1),W=(0,i.Uk)("Close"),B={class:"row",style:{width:"100%",height:"100%"}},U={ref:"main_draw",style:{width:"100%",height:"100%","margin-left":"5%"}},q=(0,i.Uk)("进程命中的规则: "),y=(0,i.Uk)(" 无 "),Q=(0,i.Uk)("attck矩阵: "),V=(0,i.Uk)(" 无 ");function S(t,e,a,S,I,x){const Z=(0,i.up)("q-icon"),K=(0,i.up)("q-item-section"),E=(0,i.up)("q-item-label"),Y=(0,i.up)("q-item"),z=(0,i.up)("q-card-section"),H=(0,i.up)("q-card"),j=(0,i.up)("q-chip"),N=(0,i.up)("q-btn"),O=(0,i.up)("q-card-actions"),F=(0,i.up)("q-timeline-entry"),L=(0,i.up)("q-timeline"),T=(0,i.up)("q-input"),X=(0,i.up)("q-dialog"),J=(0,i.up)("q-space"),P=(0,i.up)("q-tooltip"),R=(0,i.up)("q-bar"),G=(0,i.up)("q-separator"),M=(0,i.up)("q-list"),$=(0,i.up)("q-drawer"),tt=(0,i.Q2)("close-popup");return(0,i.wg)(),(0,i.iD)(i.HY,null,[(0,i._)("div",null,[(0,i._)("div",s,[(0,i.Wm)(H,{class:"bg-transparent no-shadow no-border"},{default:(0,i.w5)((()=>[(0,i.Wm)(z,{class:"q-pa-none"},{default:(0,i.w5)((()=>[(0,i._)("div",o,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.Threatitems,((t,e)=>((0,i.wg)(),(0,i.iD)("div",{key:e,class:"col-md-3 col-sm-12 col-xs-12"},[(0,i.Wm)(Y,{style:(0,l.j5)(`background-color: ${t.color1}`),class:"q-pa-none"},{default:(0,i.w5)((()=>[(0,i.Wm)(K,{side:"",style:(0,l.j5)(`background-color: ${t.color2}`),class:"q-pa-lg q-mr-none text-white"},{default:(0,i.w5)((()=>[(0,i.Wm)(Z,{name:t.icon,color:"white",size:"24px"},null,8,["name"])])),_:2},1032,["style"]),(0,i.Wm)(K,{class:"q-pa-md q-ml-none text-white"},{default:(0,i.w5)((()=>[(0,i.Wm)(E,{class:"text-white text-h6 text-weight-bolder"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.value),1)])),_:2},1024),(0,i.Wm)(E,null,{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(t.title),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["style"])])))),128))])])),_:1})])),_:1})]),(0,i._)("div",n,[r,(0,i._)("div",d,[(0,i._)("div",h,[(0,i.Wm)(L,{layout:"dense",side:"right",color:"red"},{default:(0,i.w5)((()=>[t.server_threat.data&&0!=t.server_threat.data.length?(0,i.kq)("",!0):((0,i.wg)(),(0,i.iD)("h4",c,"暂无可用数据,下次刷新时间 "+(0,l.zw)(t.last_refresh)+"...",1)),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.server_threat.data,((e,a)=>((0,i.wg)(),(0,i.j4)(F,{key:a,subtitle:"主机:"+e.host,side:"left"},{default:(0,i.w5)((()=>[(0,i._)("div",null,[(0,i.Wm)(H,{flat:"",bordered:"",style:{overflow:"auto"},"thumb-style":t.thumbStyle,"bar-style":t.barStyle},{default:(0,i.w5)((()=>[(0,i.Wm)(z,{horizontal:""},{default:(0,i.w5)((()=>[u,(0,i.Wm)(O,{vertical:"",class:"justify-around q-px-md"},{default:(0,i.w5)((()=>[(0,i._)("div",null,"进程链hash: "+(0,l.zw)(e.chain_hash),1),(0,i._)("div",null,"进程: "+(0,l.zw)(e.start_process.path),1),(0,i._)("div",null,"用户: "+(0,l.zw)(e.start_process.user),1),(0,i._)("div",null,[w,(0,i.Wm)(j,{square:"",color:"orange","text-color":"white","icon-right":"visibility"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e.risk_score),1)])),_:2},1024)]),(0,i._)("div",null,[p,(0,i.Wm)(j,{square:"",color:1==e.is_end?"negative":"red","text-color":"white"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(1==e.is_end?"已结束":"进行中"),1)])),_:2},1032,["color"])]),(0,i._)("div",null,[m,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.attck_hit_list,((t,e)=>((0,i.wg)(),(0,i.j4)(j,{key:t,square:"",color:"rgb(239,243,246)"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e)+" ("+(0,l.zw)(t)+") ",1)])),_:2},1024)))),128))]),(0,i._)("div",null,[g,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.hit_rule,((t,e)=>((0,i.wg)(),(0,i.j4)(j,{key:t,square:"",color:"red","text-color":"white"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e)+" ("+(0,l.zw)(t)+") ",1)])),_:2},1024)))),128)),"{}"==JSON.stringify(e.hit_rule)?((0,i.wg)(),(0,i.j4)(j,{key:0,square:"",color:"negative","text-color":"white"},{default:(0,i.w5)((()=>[A])),_:1})):(0,i.kq)("",!0)]),(0,i._)("div",null,[(0,i.Wm)(N,{flat:"",color:"accent",onClick:a=>t.show_details(e.id),icon:"open_in_new"},{default:(0,i.w5)((()=>[_])),_:2},1032,["onClick"]),(0,i.Wm)(N,{flat:"",color:"accent",onClick:a=>t.search_vt(e.start_process.hash),icon:"search"},{default:(0,i.w5)((()=>[k])),_:2},1032,["onClick"]),(0,i.Wm)(N,{flat:"",color:"accent",onClick:a=>t.handle_threat(e.id,1),icon:"done"},{default:(0,i.w5)((()=>[f])),_:2},1032,["onClick"]),(0,i.Wm)(N,{flat:"",color:"accent",onClick:a=>t.handle_threat(e.id,2),icon:"texture"},{default:(0,i.w5)((()=>[C])),_:2},1032,["onClick"]),(0,i.Wm)(N,{flat:"",color:"accent",icon:"close",onClick:a=>t.delete_threat(e.id)},{default:(0,i.w5)((()=>[b])),_:2},1032,["onClick"])])])),_:2},1024)])),_:2},1024)])),_:2},1032,["thumb-style","bar-style"])])])),_:2},1032,["subtitle"])))),128))])),_:1})])]),v])]),(0,i.Wm)(X,{modelValue:t.addwhiteListHash,"onUpdate:modelValue":e[3]||(e[3]=e=>t.addwhiteListHash=e),persistent:"","transition-show":"scale","transition-hide":"scale"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{style:{"min-width":"350px"}},{default:(0,i.w5)((()=>[(0,i.Wm)(z,null,{default:(0,i.w5)((()=>[D])),_:1}),(0,i.Wm)(z,{class:"q-pt-none"},{default:(0,i.w5)((()=>[(0,i.Wm)(T,{dense:"",modelValue:this.whiteListPostData.reason,"onUpdate:modelValue":e[0]||(e[0]=t=>this.whiteListPostData.reason=t),autofocus:""},null,8,["modelValue"])])),_:1}),(0,i.Wm)(O,{align:"right",class:"text-primary"},{default:(0,i.w5)((()=>[(0,i.wy)((0,i.Wm)(N,{flat:"",label:"取消",onClick:e[1]||(e[1]=e=>t.addwhiteListHash=!1)},null,512),[[tt]]),(0,i.wy)((0,i.Wm)(N,{flat:"",label:"加入白名单",onClick:e[2]||(e[2]=e=>t.add_to_white_hash_post())},null,512),[[tt]])])),_:1})])),_:1})])),_:1},8,["modelValue"]),(0,i.Wm)(X,{modelValue:t.dialog,"onUpdate:modelValue":e[8]||(e[8]=e=>t.dialog=e),persistent:"",maximized:t.maximizedToggle,"transition-show":"slide-up","transition-hide":"slide-down"},{default:(0,i.w5)((()=>[(0,i.Wm)(H,{class:"text-white"},{default:(0,i.w5)((()=>[(0,i.Wm)(R,null,{default:(0,i.w5)((()=>[(0,i.Wm)(J),(0,i.wy)(((0,i.wg)(),(0,i.j4)(N,{dense:"",flat:"",icon:"close"},{default:(0,i.w5)((()=>[(0,i.Wm)(P,{"content-class":"bg-white text-primary"},{default:(0,i.w5)((()=>[W])),_:1})])),_:1})),[[tt]])])),_:1}),(0,i._)("div",B,[(0,i._)("div",U," 1 ",512)]),t.processChainShowDetails?((0,i.wg)(),(0,i.j4)($,{key:0,"show-if-above":"",modelValue:t.processChainShowDetails,"onUpdate:modelValue":e[7]||(e[7]=e=>t.processChainShowDetails=e),side:"right",bordered:"",width:"350",class:"text-dark"},{default:(0,i.w5)((()=>[(0,i.Wm)(M,{style:{width:"100%","word-break":"break-all"}},{default:(0,i.w5)((()=>[(0,i.Wm)(Y,null,{default:(0,i.w5)((()=>[(0,i.Wm)(K,null,{default:(0,i.w5)((()=>[(0,i.Uk)("活跃状态: "+(0,l.zw)(t.processChainDetails.active?"运行中":"已结束"),1)])),_:1})])),_:1}),(0,i.Wm)(G),(0,i.Wm)(Y,null,{default:(0,i.w5)((()=>[(0,i.Wm)(K,null,{default:(0,i.w5)((()=>[(0,i.Uk)("进程名字: "+(0,l.zw)(t.processChainDetails.name),1)])),_:1})])),_:1}),(0,i.Wm)(G),(0,i.Wm)(Y,null,{default:(0,i.w5)((()=>[(0,i.Wm)(K,null,{default:(0,i.w5)((()=>[(0,i.Uk)("进程路径: "+(0,l.zw)(t.processChainDetails.path),1)])),_:1})])),_:1}),(0,i.Wm)(G),(0,i.Wm)(Y,null,{default:(0,i.w5)((()=>[(0,i.Wm)(K,null,{default:(0,i.w5)((()=>[(0,i.Uk)("进程参数: "+(0,l.zw)(t.processChainDetails.params),1)])),_:1})])),_:1}),(0,i.Wm)(G),(0,i.Wm)(Y,null,{default:(0,i.w5)((()=>[(0,i.Wm)(K,null,{default:(0,i.w5)((()=>[(0,i.Uk)("进程id: "+(0,l.zw)(t.processChainDetails.pid),1)])),_:1})])),_:1}),(0,i.Wm)(G),(0,i.Wm)(Y,null,{default:(0,i.w5)((()=>[(0,i.Wm)(K,null,{default:(0,i.w5)((()=>[(0,i.Uk)("父进程id: "+(0,l.zw)(t.processChainDetails.ppid),1)])),_:1})])),_:1}),(0,i.Wm)(G),(0,i.Wm)(Y,null,{default:(0,i.w5)((()=>[(0,i.Wm)(K,null,{default:(0,i.w5)((()=>[(0,i.Uk)("进程hash: "+(0,l.zw)(t.processChainDetails.md5),1)])),_:1})])),_:1}),(0,i.Wm)(G),(0,i.Wm)(Y,null,{default:(0,i.w5)((()=>[(0,i.Wm)(K,null,{default:(0,i.w5)((()=>[(0,i.Uk)("是否在白名单中: "+(0,l.zw)(t.processChainDetails.isWhite?"是":"否"),1)])),_:1})])),_:1}),(0,i.Wm)(G),(0,i.Wm)(Y,null,{default:(0,i.w5)((()=>[(0,i.Wm)(K,null,{default:(0,i.w5)((()=>[q,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.processChainDetails.hitRules,((t,e)=>((0,i.wg)(),(0,i.j4)(j,{key:t,square:"",color:"rgb(239,243,246)"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e)+" ("+(0,l.zw)(t)+") ",1)])),_:2},1024)))),128)),"{}"==JSON.stringify(t.processChainDetails.hitRules)?((0,i.wg)(),(0,i.j4)(j,{key:0,square:"",color:"rgb(239,243,246)"},{default:(0,i.w5)((()=>[y])),_:1})):(0,i.kq)("",!0)])),_:1})])),_:1}),(0,i.Wm)(Y,null,{default:(0,i.w5)((()=>[(0,i.Wm)(K,null,{default:(0,i.w5)((()=>[Q,((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.processChainDetails.hitAttck,((t,e)=>((0,i.wg)(),(0,i.j4)(j,{key:t,square:"",color:"rgb(239,243,246)"},{default:(0,i.w5)((()=>[(0,i.Uk)((0,l.zw)(e)+" ("+(0,l.zw)(t)+") ",1)])),_:2},1024)))),128)),"{}"==JSON.stringify(t.processChainDetails.hitAttck)?((0,i.wg)(),(0,i.j4)(j,{key:0,square:"",color:"rgb(239,243,246)"},{default:(0,i.w5)((()=>[V])),_:1})):(0,i.kq)("",!0)])),_:1})])),_:1}),(0,i.Wm)(Y,null,{default:(0,i.w5)((()=>[(0,i.Wm)(N,{icon:"search",outline:"",style:{color:"grey",width:"100%"},label:"搜索hash",onClick:e[4]||(e[4]=e=>t.search_vt(t.processChainDetails.md5))})])),_:1}),(0,i.Wm)(Y,null,{default:(0,i.w5)((()=>[0==t.processChainDetails.isWhite?((0,i.wg)(),(0,i.j4)(N,{key:0,icon:"texture",outline:"",style:{color:"grey",width:"100%"},label:"加入白名单",onClick:e[5]||(e[5]=e=>t.add_to_white_hash_pre(t.processChainDetails.path,t.processChainDetails.md5))})):((0,i.wg)(),(0,i.j4)(N,{key:1,icon:"clear",outline:"",style:{color:"grey",width:"100%"},label:"从白名单中删除",onClick:e[6]||(e[6]=e=>t.delete_white_hash(t.processChainDetails.md5))}))])),_:1})])),_:1})])),_:1},8,["modelValue"])):(0,i.kq)("",!0)])),_:1})])),_:1},8,["modelValue","maximized"])],64)}var I=a(52),x=a.n(I),Z=a(2256);const K=(0,i.aZ)({name:"PageIndex",data:function(){return{addwhiteListHash:!1,whiteListPostData:{path:"",hash:"",reason:""},processChainShowDetails:!1,last_refresh:360,processChainDetails:{hash:"",prams:"",hitRules:[],hitAttck:[],isWhite:!1,whiteListReason:""},thumbStyle:{right:"4px",borderRadius:"5px",backgroundColor:"#027be3",width:"5px",opacity:.75},barStyle:{right:"2px",borderRadius:"9px",backgroundColor:"#027be3",width:"9px",opacity:.2},threatStatistics:{all:1,confirm:0,ingore:1,working:0},Threatitems:[{title:"发现的威胁",icon:"remove_red_eye",value:"200",color1:"#5064b5",color2:"#3e51b5"},{title:"确认的威胁",icon:"flash_on",value:"500",color1:"#f37169",color2:"#f34636"},{title:"忽略的威胁",icon:"texture",value:"50",color1:"#ea6a7f",color2:"#ea4b64"},{title:"进行中的威胁",icon:"bar_chart",value:"1020",color1:"#a270b1",color2:"#9f52b1"}],dialog:!1,maximizedToggle:!0,server_threat:{},select_chain_data:{}}},methods:{delete_white_hash(t){x().get("/api/v1/del/white_list?hash="+t).then((t=>{this.processChainDetails.isWhite=!1}))},query_white_hash(t){x().get("/api/v1/query/white_list?hash="+t).then((t=>{this.processChainDetails.isWhite=1===t.data.result}))},add_to_white_hash_pre(t,e){this.whiteListPostData={path:t,hash:e,reason:""},this.addwhiteListHash=!0,console.log("addwhiteListHash",this.addwhiteListHash)},add_to_white_hash_post(){x().post("/api/v1/set/white_list",this.whiteListPostData).then((t=>{this.processChainDetails.isWhite=!0}))},set_chain_data(t){if(t.path){const e=t.path.split("\\");t.name=e[e.length-1],console.log(t.name);for(const a in t.children)this.set_chain_data(t.children[a])}},draw_tree(){this.set_chain_data(this.select_chain_data);const t=this.$refs.main_draw,e=Z.S1(t),a={tooltip:{trigger:"item",triggerOn:"mousemove",formatter:function(t){const e=t.data;let a="<div>参数: "+e.params+"</div><div> hash: "+e.md5+"</div><div>命名规则列表: ";0===e.operationlist.length&&(a+="无");for(const i in e.operationlist)a+=" "+i+"["+e.operationlist[i]+"] ";return a+="</div>",a}},series:[{roam:!0,type:"tree",id:0,name:"tree1",data:[this.select_chain_data],top:"5%",left:"15%",bottom:"22%",right:"20%",edgeShape:"polyline",edgeForkPosition:"63%",initialTreeDepth:60,lineStyle:{width:2},label:{backgroundColor:"#fff",position:"left",verticalAlign:"middle",align:"right"},leaves:{label:{position:"right",verticalAlign:"middle",align:"left"}},emphasis:{focus:"descendant"},symbolSize:[30,30],symbol:"image://data:image/png;base64,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",expandAndCollapse:!1,animationDuration:350,animationDurationUpdate:450}]};e.setOption(a),e.on("click",(t=>{const e=t.data;this.processChainDetails={path:e.path,active:e.active,md5:e.md5,name:e.name,params:e.params,pid:e.pid,ppid:e.ppid,hitRules:void 0===e.operationlist?{}:e.operationlist,hitAttck:void 0===e.attck_hit_list?{}:e.attck_hit_list,isWhite:!1},this.query_white_hash(e.md5),this.processChainShowDetails=!0}))},search_vt(t){window.open("https://www.virustotal.com/gui/search/"+t,"_blank")},delete_threat(t){x().get("/api/v1/get/process_chain/delete?id="+t,{"Content-Type":"application/json"}).then((t=>{this.get_clientids()}))},handle_threat(t,e){x().get("/api/v1/get/process_chain/handle?id="+t+"&handletype="+e,{"Content-Type":"application/json"}).then((t=>{this.get_clientids()}))},show_details(t){x().get("/api/v1/get/process_chain/pull?id="+t,{"Content-Type":"application/json"}).then((t=>{const e=t.data;e.data&&(this.select_chain_data=e.data.chain.process_node,this.dialog=!0,console.log("this.select_chain_data",this.select_chain_data),this.$nextTick((()=>{this.draw_tree()})))}))},get_threatStatistics(){x().get("/api/v1/get/threat_statistics",{"Content-Type":"application/json"}).then((t=>{const e=t.data;e.data&&(this.threatStatistics=e.data,this.Threatitems[0].value=this.threatStatistics.all,this.Threatitems[1].value=this.threatStatistics.confirm,this.Threatitems[2].value=this.threatStatistics.ingore,this.Threatitems[3].value=this.threatStatistics.working)}))},get_clientids(){const t=this.$route.params.queryIndex,e=null===t||void 0===t?0:t;x().get("/api/v1/get/process_chain/all?query_type="+e,{"Content-Type":"application/json"}).then((t=>{const e=t.data;e.data&&(this.server_threat={data:[]},this.server_threat.data=e.data,this.get_threatStatistics())}))}},mounted(){this.get_clientids(),setInterval((()=>{this.last_refresh-=1,this.last_refresh<=0&&(this.get_clientids(),this.last_refresh=360)}),1e3)},watch:{$route(t,e){this.get_clientids()}}});var E=a(4260),Y=a(151),z=a(5589),H=a(3414),j=a(2035),N=a(4554),O=a(2350),F=a(1432),L=a(3424),T=a(9367),X=a(7030),J=a(8240),P=a(6778),R=a(4842),G=a(846),M=a(2025),$=a(8870),tt=a(2901),et=a(7011),at=a(5869),it=a(677),lt=a(7518),st=a.n(lt);const ot=(0,E.Z)(K,[["render",S]]),nt=ot;st()(K,"components",{QCard:Y.Z,QCardSection:z.Z,QItem:H.Z,QItemSection:j.Z,QIcon:N.Z,QItemLabel:O.Z,QTimeline:F.Z,QTimelineEntry:L.Z,QCardActions:T.Z,QChip:X.Z,QBtn:J.Z,QDialog:P.Z,QInput:R.Z,QBar:G.Z,QSpace:M.Z,QTooltip:$.Z,QDrawer:tt.Z,QList:et.Z,QSeparator:at.Z}),st()(K,"directives",{ClosePopup:it.Z})}}]);